# üñºÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏ô Production

## üìã ‡∏™‡∏£‡∏∏‡∏õ‡∏õ‡∏±‡∏ç‡∏´‡∏≤

‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö: ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏ô Production ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ú‡∏¥‡∏î‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•

## üîç ‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏Ç‡∏≠‡∏á‡∏õ‡∏±‡∏ç‡∏´‡∏≤

1. **‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ `NEXT_PUBLIC_BASE_URL`** ‡πÉ‡∏ô production environment
2. **‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ `localhost` ‡πÉ‡∏ô production** ‡∏ó‡∏≥‡πÉ‡∏´‡πâ URL ‡∏Ç‡∏≠‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
3. **‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡πÅ‡∏ô‡∏Å External API ‡πÅ‡∏•‡∏∞ Local Storage** ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ô production

## ‚úÖ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

### 1. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment Variables

‡πÉ‡∏ô `.env.production` ‡πÄ‡∏û‡∏¥‡πà‡∏°:

```bash
# Application Base URL (‚ö†Ô∏è REQUIRED for image display)
NEXT_PUBLIC_BASE_URL="http://golfcar.go2kt.com:3000"

# Security Configuration
ALLOWED_ORIGINS="http://golfcar.go2kt.com:3000,http://golfcar.go2kt.com:8080"
```

### 2. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÇ‡∏Ñ‡πâ‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL

‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå `app/api/upload/maintenance/route.ts` ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:

```typescript
// ‡πÄ‡∏î‡∏¥‡∏° (‡∏ú‡∏¥‡∏î)
const externalUploads = uploadedFiles.filter(url => !url.includes('localhost'));
const localFallbacks = uploadedFiles.filter(url => url.includes('localhost'));

// ‡πÉ‡∏´‡∏°‡πà (‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á)
const baseUrl = process.env.NEXT_PUBLIC_BASE_URL || 'http://localhost:3000';
const localDomain = baseUrl.includes('localhost') ? 'localhost' : new URL(baseUrl).hostname;
const externalUploads = uploadedFiles.filter(url => !url.includes(localDomain));
const localFallbacks = uploadedFiles.filter(url => url.includes(localDomain));
```

### 3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö API Route ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏¥‡∏£‡πå‡∏ü‡πÑ‡∏ü‡∏•‡πå

‡πÑ‡∏ü‡∏•‡πå `app/api/uploads/maintenance/[filename]/route.ts` ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á:

```typescript
const UPLOAD_DIR = path.join(process.cwd(), 'public', 'uploads', 'maintenance');
```

### 4. ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Next.js Image Configuration

‡πÉ‡∏ô `next.config.mjs` ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:

```javascript
images: {
  domains: ['localhost', 'golfcar.go2kt.com'],
  formats: ['image/webp', 'image/avif'],
},
```

## üöÄ ‡∏Å‡∏≤‡∏£ Deploy

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: ‡πÉ‡∏ä‡πâ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

```bash
./deploy-production.sh
```

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: Manual Deploy

```bash
# 1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö environment variables
cat .env.production

# 2. Build application
NODE_ENV=production npm run build

# 3. Start production server
NODE_ENV=production npm start

# ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ PM2
NODE_ENV=production pm2 start npm --name "golfcar-maintenance" -- start
```

## üîß ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏á Deploy

### 1. Health Check

```bash
curl http://golfcar.go2kt.com:3000/api/health
```

### 2. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û

1. ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á
2. ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á

### 3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡∏Ç‡∏≠‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û

‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏ß‡∏£‡∏°‡∏µ URL ‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö:
- **External API**: `http://golfcar.go2kt.com:8080/uploads/maintenance/filename.jpg`
- **Local Fallback**: `http://golfcar.go2kt.com:3000/api/uploads/maintenance/filename.jpg`

## üêõ ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á

1. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Console Logs**:
   ```bash
   pm2 logs golfcar-maintenance
   ```

2. **‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î**:
   ```bash
   ls -la public/uploads/maintenance/
   ```

3. **‡∏ó‡∏î‡∏™‡∏≠‡∏ö API Route**:
   ```bash
   curl http://golfcar.go2kt.com:3000/api/uploads/maintenance/[filename]
   ```

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: CORS Error

‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö `ALLOWED_ORIGINS` ‡πÉ‡∏ô `.env.production`:
```bash
ALLOWED_ORIGINS="http://golfcar.go2kt.com:3000,http://golfcar.go2kt.com:8080"
```

### ‡∏õ‡∏±‡∏ç‡∏´‡∏≤: External API ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô

1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ External API:
   ```bash
   curl http://golfcar.go2kt.com:8080/api/health
   ```

2. ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÉ‡∏ä‡πâ Local Storage ‡πÄ‡∏õ‡πá‡∏ô fallback ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

## üìä ‡∏Å‡∏≤‡∏£ Monitor

### PM2 Commands

```bash
pm2 status              # ‡∏î‡∏π‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
pm2 logs               # ‡∏î‡∏π logs
pm2 restart all        # restart application
pm2 stop all           # ‡∏´‡∏¢‡∏∏‡∏î application
```

### Log Files

- Application logs: `pm2 logs`
- Error logs: ‡∏î‡∏π‡πÉ‡∏ô console ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤

## üéØ ‡∏™‡∏£‡∏∏‡∏õ

‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏ô Production ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£:

1. ‚úÖ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ `NEXT_PUBLIC_BASE_URL` ‡πÉ‡∏ô `.env.production`
2. ‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏Ñ‡πâ‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö URL ‡πÉ‡∏ô upload route
3. ‚úÖ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö API route ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏™‡∏¥‡∏£‡πå‡∏ü‡πÑ‡∏ü‡∏•‡πå
4. ‚úÖ Deploy ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
5. ‚úÖ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏á deploy

‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Ñ‡∏ß‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ô Production ‡πÅ‡∏•‡πâ‡∏ß